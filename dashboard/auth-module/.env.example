# =============================================================================
# CPF AUTH MODULE - ENVIRONMENT CONFIGURATION
# =============================================================================
# Copy this file to .env and configure all values before starting the server
# SECURITY WARNING: Never commit .env file to version control!
# =============================================================================

# -----------------------------------------------------------------------------
# SERVER CONFIGURATION
# -----------------------------------------------------------------------------
NODE_ENV=development
AUTH_PORT=3001
AUTH_HOST=localhost

# Main dashboard URL (for redirects and CORS)
DASHBOARD_URL=http://localhost:3000

# -----------------------------------------------------------------------------
# DATABASE CONFIGURATION
# -----------------------------------------------------------------------------
# Use the same database as the main dashboard
DB_TYPE=postgres
DB_HOST=localhost
DB_PORT=5432
DB_NAME=cpf_dashboard
DB_USER=postgres
DB_PASSWORD=your_secure_password_here

# Connection pool settings
DB_POOL_MIN=2
DB_POOL_MAX=10

# -----------------------------------------------------------------------------
# JWT CONFIGURATION
# -----------------------------------------------------------------------------
# IMPORTANT: Generate strong random secrets for production!
# Use: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"

# Access token (short-lived)
JWT_ACCESS_SECRET=your_access_token_secret_min_64_chars_here_change_in_production
JWT_ACCESS_EXPIRES_IN=15m

# Refresh token (long-lived)
JWT_REFRESH_SECRET=your_refresh_token_secret_min_64_chars_here_change_in_production
JWT_REFRESH_EXPIRES_IN=7d

# Email verification token
JWT_EMAIL_SECRET=your_email_token_secret_min_64_chars_here_change_in_production
JWT_EMAIL_EXPIRES_IN=24h

# Password reset token
JWT_RESET_SECRET=your_reset_token_secret_min_64_chars_here_change_in_production
JWT_RESET_EXPIRES_IN=1h

# -----------------------------------------------------------------------------
# SECURITY CONFIGURATION
# -----------------------------------------------------------------------------
# Password hashing (Argon2id)
ARGON2_MEMORY_COST=65536
ARGON2_TIME_COST=3
ARGON2_PARALLELISM=4

# Rate limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_LOGIN_MAX=5

# Account lockout
LOCKOUT_THRESHOLD=5
LOCKOUT_DURATION_MINUTES=30

# Session settings
SESSION_ABSOLUTE_TIMEOUT_HOURS=24
MAX_SESSIONS_PER_USER=5

# Account expiration default (days)
ACCOUNT_EXPIRY_DEFAULT_DAYS=365

# -----------------------------------------------------------------------------
# RESEND EMAIL CONFIGURATION
# -----------------------------------------------------------------------------
# Get your API key from https://resend.com
RESEND_API_KEY=re_your_api_key_here

# Email sender configuration
EMAIL_FROM_NAME=CPF Dashboard
EMAIL_FROM_ADDRESS=noreply@yourdomain.com

# Email templates
EMAIL_VERIFY_SUBJECT_EN=Verify your CPF Dashboard account
EMAIL_VERIFY_SUBJECT_IT=Verifica il tuo account CPF Dashboard

EMAIL_RESET_SUBJECT_EN=Reset your password
EMAIL_RESET_SUBJECT_IT=Reimposta la tua password

EMAIL_WELCOME_SUBJECT_EN=Welcome to CPF Dashboard
EMAIL_WELCOME_SUBJECT_IT=Benvenuto in CPF Dashboard

EMAIL_LOCKED_SUBJECT_EN=Account locked - Security alert
EMAIL_LOCKED_SUBJECT_IT=Account bloccato - Avviso di sicurezza

EMAIL_EXPIRY_WARNING_SUBJECT_EN=Your account expires in 7 days
EMAIL_EXPIRY_WARNING_SUBJECT_IT=Il tuo account scade tra 7 giorni

# -----------------------------------------------------------------------------
# REGISTRATION SETTINGS
# -----------------------------------------------------------------------------
# If true, new registrations require admin approval
REGISTRATION_REQUIRES_APPROVAL=false

# If true, email verification is required before login
REGISTRATION_REQUIRES_EMAIL_VERIFICATION=true

# Allowed email domains (comma-separated, empty = all allowed)
# Example: company.com,trusted-partner.org
ALLOWED_EMAIL_DOMAINS=

# -----------------------------------------------------------------------------
# ADMIN CONFIGURATION
# -----------------------------------------------------------------------------
# Initial super admin (created on first db:init)
INITIAL_ADMIN_EMAIL=admin@yourdomain.com
INITIAL_ADMIN_PASSWORD=ChangeThisSecurePassword123!
INITIAL_ADMIN_FIRST_NAME=Super
INITIAL_ADMIN_LAST_NAME=Admin

# -----------------------------------------------------------------------------
# CORS CONFIGURATION
# -----------------------------------------------------------------------------
# Allowed origins (comma-separated)
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001

# -----------------------------------------------------------------------------
# LOGGING
# -----------------------------------------------------------------------------
LOG_LEVEL=info
LOG_AUDIT_ENABLED=true
LOG_AUDIT_RETENTION_DAYS=90

# -----------------------------------------------------------------------------
# OPTIONAL: TWO-FACTOR AUTHENTICATION (Future)
# -----------------------------------------------------------------------------
# MFA_ENABLED=false
# MFA_ISSUER=CPF Dashboard
