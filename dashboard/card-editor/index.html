<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CPF Card Editor - Interactive Indicator Cards</title>
    <link rel="stylesheet" href="../shared/styles.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Header -->
    <div class="dashboard-header" style="background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 50%, var(--accent) 100%);">
        <div style="display: flex; justify-content: space-between; align-items: center; width: 100%; padding: 0 30px;">
            <div>
                <a href="../index.html" style="display: inline-block; color: white; text-decoration: none; opacity: 0.9; margin-bottom: 10px; font-size: 14px;">
                    ‚Üê Back to Dashboard
                </a>
                <h1 style="font-size: 32px; font-weight: 300; color: white; margin-bottom: 5px;">
                    üìù CPF Card Editor
                </h1>
                <p class="subtitle">Edit Interactive Indicator Cards (Auditor Field Kit)</p>
            </div>
            <div style="display: flex; gap: 10px; align-items: center;">
                <div id="github-status" style="padding: 8px 16px; background: rgba(255,255,255,0.2); border-radius: 20px; font-size: 14px; color: white;">
                    <span id="status-icon">üíæ</span> <span id="status-text">Local Mode</span>
                </div>
                <input type="file" id="load-json-input" accept=".json" style="display: none;">
                <button id="load-json-btn" class="sidebar-open-btn" title="Load JSON file from computer">
                    üìÇ Load JSON
                </button>
                <button id="save-local-btn" class="sidebar-open-btn" title="Save to local file">
                    üíæ Save Local
                </button>
                <button id="save-github-btn" class="sidebar-open-btn" style="display: none;" title="Commit to GitHub">
                    üì§ Commit to GitHub
                </button>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="editor-container">
        <!-- Sidebar: Card Navigation -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h2 style="margin: 0;">Cards</h2>
                <span id="card-count" class="badge">0</span>
            </div>
            <div class="sidebar-controls">
                <input type="text" id="card-search" class="search-input" placeholder="üîç Search cards...">
                <select id="category-filter" class="sort-select">
                    <option value="">All Categories</option>
                    <option value="1">1.x Authority</option>
                    <option value="2">2.x Temporal</option>
                    <option value="3">3.x Social</option>
                    <option value="4">4.x Affective</option>
                    <option value="5">5.x Cognitive</option>
                    <option value="6">6.x Group</option>
                    <option value="7">7.x Stress</option>
                    <option value="8">8.x Unconscious</option>
                    <option value="9">9.x AI</option>
                    <option value="10">10.x Convergent</option>
                </select>
            </div>
            <div class="sidebar-content">
                <div id="card-list" class="org-list">
                    <div class="loading">
                        <div class="loading-spinner"></div>
                        <div>Loading cards...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content: Editor + Preview -->
        <div class="main-content">
            <!-- Alert Container -->
            <div id="alertContainer"></div>

            <!-- Empty State -->
            <div id="emptyState" class="empty-state">
                <div class="empty-state-icon">üìù</div>
                <h2 class="empty-state-title">Select a Card to Edit</h2>
                <p class="empty-state-text">Choose a card from the sidebar to begin editing</p>
            </div>

            <!-- Editor Section -->
            <div id="editorSection" class="hidden">
                <!-- Tabs -->
                <div class="dashboard-tabs">
                    <button class="tab active" data-tab="edit">‚úèÔ∏è Edit</button>
                    <button class="tab" data-tab="preview">üëÅÔ∏è Preview</button>
                    <button class="tab" data-tab="json">{ } Raw JSON</button>
                </div>

                <!-- Edit Tab -->
                <div id="editTab" class="tab-content active">
                    <div class="card-editor-form" id="cardEditorForm">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- Preview Tab -->
                <div id="previewTab" class="tab-content">
                    <div class="card-preview" id="cardPreview">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- JSON Tab -->
                <div id="jsonTab" class="tab-content">
                    <div class="json-editor">
                        <textarea id="jsonEditor" spellcheck="false"></textarea>
                        <button id="format-json-btn" class="btn btn-secondary">Format JSON</button>
                        <button id="apply-json-btn" class="btn btn-primary">Apply Changes</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Shared UI utilities -->
    <script src="../shared/ui-utils.js"></script>
    <script type="module" src="editor.js"></script>
</body>
</html>
